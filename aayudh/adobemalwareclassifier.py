"""
The BSD License

Copyright (c) 2012, Adobe Systems Incorporated
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

-Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
-Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
-Neither the name of the Adobe Systems Incorporated nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL Adobe Systems Incorporated OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

"""
# Adobe(R) Malware Classifier
# Contributor: Karthik Raman, Adobe Systems Incorporated
# Dependencies: Python pefile, Python argparse
# Program to classify unknown Win32 binaries (EXEs or DLLs)  into
# 0 = CLEAN
# 1 = DIRTY
# UNKNOWN
""" Results on dataset of ~130000 dirty, ~ 16000 clean files:
    (False Positives, True Negatives, True Positives, rates
J48     FP      TN      TP      FN      TP Rate     FP Rate     Accuracy
       7683    37171   130302  3451    0.97419871      0.171289071     0.937662018

J48Graft FP      TN      TP      FN      TP Rate    FP Rate     Accuracy
       6780    38074   129087  4666    0.965114801     0.151157087     0.935915166


PART    FP      TN      TP      FN      TP Rate     FP Rate     Accuracy
       7074    36492   125060  9412    0.930007734     0.162374329     0.907401791


Ridor   FP      TN      TP      FN      TP Rate     FP Rate     Accuracy
       7390    37935   114194  20930   0.845105237     0.163044677     0.843058149
"""

# peattribute:count_of_times_its_referenced
# resourcesize:97, virtualsize:89, imageversion:87, numberofsections:81, exportsize:77, iatrva:65, debugsize:63

def run_J48(debugsize, imageversion, iatrva, exportsize, resourcesize, virtualsize, numberofsections):
  isDirty = False
  if debugsize <=0:
    if exportsize <= 211:
      if imageversion <= 520:
        if virtualsize <= 130:
          if virtualsize <= 5:
            if resourcesize <= 37520:
              isDirty = True
            elif resourcesize > 37520:
              if numberofsections <= 2:
                if iatrva <= 2048:
                  isDirty = False
                else:
                  isDirty = True
              else:
                isDirty = True
          else:
            if virtualsize <= 12:
              if numberofsections <= 3:
                isDirty = False
              else:
                isDirty = True
            else:
              isDirty = True
        else:
          isDirty = True
      else:
        if resourcesize <= 0:
          if imageversion <= 1000:
            if numberofsections <= 4:
              isDirty = True
            else:
              if exportsize <= 74:
                if virtualsize <= 1556:
                  isDirty = True
                else:
                  isDirty = False
              else:
                isDirty = False
          else:
            isDirty = True
        else:
          if numberofsections <= 2:
            if imageversion <= 3420:
              isDirty = True
            else:
              isDirty = False
          else:
            isDirty = True
    else:
      if imageversion <= 0:
        if exportsize <= 23330:
          if iatrva <= 98304:
            if numberofsections <= 3:
              isDirty = True
            else:
              if iatrva <= 53872:
                isDirty = False
              else:
                if exportsize <= 273:
                  isDirty = True
                else:
                  if resourcesize <= 1016:
                    isDirty = True
                  else:
                    isDirty = False
          else:
            isDirty = False
        else:
          isDirty = True
      else:
        isDirty = False
  else:
    if resourcesize <= 545:
      if exportsize <= 92:
        if numberofsections <= 4:
          isDirty = False
        else:
          isDirty = True
    else:
      if iatrva <= 94208:
        if numberofsections <= 5:
          if exportsize <= 0:
            if numberofsections <= 4:
              if iatrva <= 13504:
                if imageversion <= 353:
                  if numberofsections <= 3:
                    if iatrva <= 6144:
                      if iatrva <= 2048:
                        isDirty = False
                      else:
                        if virtualsize <= 496:
                          isDirty = True
                        else:
                          isDirty = False
                    else:
                      isDirty = False
                  else:
                    if debugsize <= 41:
                      if resourcesize <= 22720:
                        isDirty = True
                      else:
                        isDirty = False
                    else:
                      isDirty = False
                else:
                  isDirty = False
              else:
                if resourcesize <= 35328:
                  isDirty = False
                else:
                  isDirty = True
            else:
              if iatrva <= 2048:
                isDirty = True
              else:
                isDirty = False
          else:
            isDirty = False
        else:
          if iatrva <= 1054:
            if exportsize <= 218:
              if iatrva <= 704:
                isDirty = True
              else:
                if numberofsections <= 6:
                  isDirty = True
                else:
                  isDirty = False
            else:
              isDirty = False
          else:
            isDirty = False
      else:
        if exportsize <= 0:
          if virtualsize <= 78800:
            if numberofsections <= 4:
              isDirty = False
            else:
              if imageversion <= 2340:
                if resourcesize <= 7328:
                  isDirty = True
                else:
                  isDirty = False
              else:
                isDirty = False
          else:
            isDirty = True
        else:
          if iatrva <= 106496:
            if resourcesize <= 2800:
              isDirty = False
            else:
              isDirty = True
          else:
            isDirty = False
  return isDirty
# Might need to add a isDirty = False statement if tree results in unclassified result

def run_J48Graft(debugsize, imageversion, iatrva, exportsize, resourcesize, virtualsize, numberofsections):
  isDirty = False
  if debugsize <=0:
    if exportsize <= 211:
      if imageversion <= 520:
        if virtualsize <= 130:
          if virtualsize <= 5:
            if resourcesize <= 37520:
              isDirty = True
            elif resourcesize > 37520:
              if numberofsections <= 2:
                if iatrva <= 2048:
                  if exportsize <= 67.5:
                    isDirty = False
                  else:
                    isDirty = True
                else:
                  isDirty = True
              else:
                isDirty = True
          else:
            if VirtualSize <= 12:
              if numberofsections <= 3:
                isDirty = False
              else:
                isDirty = True
            else:
              isDirty = True
        else:
          isDirty = True
      else:
        if resourcesize <= 0:
          if imageversion <= 1000:
            if numberofsections <= 4:
              isDirty = True
            else:
              if exportsize <= 74:
                if virtualsize <= 1556:
                  isDirty = True
                else:
                  if iatrva <= 5440:
                    if virtualsize <= 126474:
                      if exportsize <= 24:
                        isDirty = False
                      else:
                        isDirty = True
                    else:
                      isDirty = True
                  else:
                    isDirty = True
              else:
                isDirty = False
          else:
            isDirty = True
        else:
          if numberofsections <= 2:
            if imageversion <= 3420:
              isDirty = True
            else:
              isDirty = False
          else:
            isDirty = True
    else:
      if imageversion <= 0:
        if exportsize <= 23330:
          if iatrva <= 98304:
            if numberofsections <= 3:
              isDirty = True
            else:
              if iatrva <= 53872:
                if virtualsize <= 17.5:
                  isDirty = True
                else:
                  if numberofsections <= 10.5:
                    if resourcesize <= 3103192:
                      if exportsize <= 10858.5:
                        if virtualsize <= 116016.5:
                          isDirty = False
                        else:
                          isDirty = True
                      else:
                        isDirty = False
                    else:
                      isDirty = True
                  else:
                    isDirty = True
              else:
                if exportsize <= 273:
                  isDirty = True
                else:
                  if resourcesize <= 1016:
                    isDirty = True
                  else:
                    isDirty = False
          else:
            isDirty = False
        else:
          isDirty = True
      else:
        if exportsize <= 1006718985:
          isDirty = False
        else:
          isDirty = True
  else:
    if resourcesize <= 545:
      if exportsize <= 92:
        if numberofsections <= 4:
          isDirty = False
        else:
          if imageversion <= 6005:
            if exportsize <= 6714:
              isDirty = True
            else:
              isDirty = False
          else:
            isDirty = False
    else:
      if iatrva <= 94208:
        if numberofsections <= 5:
          if exportsize <= 0:
            if numberofsections <= 4:
              if iatrva <= 13504:
                if imageversion <= 353:
                  if numberofsections <= 3:
                    if iatrva <= 6144:
                      if iatrva <= 2048:
                        if resourcesize <= 934:
                          isDirty = True
                        else:
                          if virtualsize <= 2728:
                            isDirty = False
                          else:
                            isDirty = True
                      else:
                        if virtualsize <= 496:
                          isDirty = True
                        else:
                          isDirty = False
                    else:
                      isDirty = False
                  else:
                    if debugsize <= 41: # debug here
                      if resourcesize <= 22720:
                        if iatrva <= 2048:
                          isDirty = True
                        else:
                          if virtualsize <= 46:
                            isDirty = False
                          else:
                            isDirty = True
                      else:
                          if virtualsize <= 43030:
                            if resourcesize <= 3898348:
                              if iatrva <= 2048:
                                isDirty = True
                              else:
                                isDirty = False
                            else:
                              isDirty = True
                          else:
                            isDirty = False
                    else:
                      isDirty = False
                else:
                  isDirty = False
              else:
                if resourcesize <= 35328:
                  if imageversion <= 4005:
                    if numberofsections <= 1.5:
                      isDirty = True
                    else:
                      isDirty = False
                  else:
                    isDirty = False
                else:
                  if imageversion <= 5510:
                    if debugsize <= 42:
                      if virtualsize <= 144328:
                        if numberofsections <= 3.5:
                          isDirty = False
                        else:
                          isDirty = True
                      else:
                        isDirty = False
                    else:
                      isDirty = False
                  else:
                    isDirty = False
            else:
              if iatrva <= 2048:
                isDirty = True
              else:
                isDirty = False
          else:
            isDirty = False
        else:
          if iatrva <= 1054:
            if exportsize <= 218:
              if iatrva <= 704:
                isDirty = True
              else:
                if numberofsections <= 6:
                  isDirty = True
                else:
                  isDirty = False
            else:
              if exportsize <= 1006699445:
                if imageversion <= 5510:
                  if imageversion <= 500:
                    isDirty = True
                  else:
                    isDirty = False
                else:
                  isDirty = False
              else:
                isDirty = True
          else:
            isDirty = False
      else:
        if exportsize <= 0:
          if virtualsize <= 78800:
            if numberofsections <= 4:
              isDirty = False
            else:
              if imageversion <= 2340:
                if resourcesize <= 7328:
                  isDirty = True
                else:
                  if virtualsize <= 8288.5:
                    isDirty = True
                  else:
                    if numberofsections <= 6.5:
                      isDirty = False
                    else:
                      isDirty = True
              else:
                isDirty = False
          else:
            if imageversion <= 5515:
              isDirty = True
            else:
              isDirty = False
        else:
          if iatrva <= 106496:
            if resourcesize <= 2800:
              isDirty = False
            else:
              if imageversion <= 500:
                if resourcesize <= 5360:
                  if numberofsections <= 4.5:
                    isDirty = False
                  else:
                    if virtualsize <= 22564.5:
                      if exportsize <= 191.5:
                        if debugsize <= 42:
                          if exportsize <= 162.5:
                            isDirty = False
                          else:
                            if virtualsize <= 10682:
                              isDirty = False
                            else:
                              if resourcesize <= 3412:
                                isDirty = False
                              else:
                                isDirty = True
                        else:
                          isDirty = False
                      else:
                        isDirty = False
                    else:
                      isDirty = False
                else:
                  isDirty = False
              else:
                isDirty = False
          else:
            isDirty = False
  return isDirty
# Might need to add a isDirty = False statement if tree results in unclassified result

def run_PART(debugsize, imageversion, iatrva, exportsize, resourcesize, virtualsize, numberofsections):
  isDirty = False
  if debugsize > 0  and resourcesize > 545 and iatrva <= 94208 and numberofsections <= 5 and exportsize > 0 and numberofsections > 3:
    isDirty = False
  elif debugsize <=0 and imageversion <= 4900 and exportsize <= 71 and imageversion <= 520 and virtualsize > 130 and iatrva <= 24576:
    isDirty = True
  elif debugsize <=0 and imageversion <= 4900 and exportsize <= 211 and resourcesize <= 32272 and numberofsections <= 10 and virtualsize <= 5 and imageversion <= 3420:
    isDirty = True
  elif debugsize > 0 and resourcesize > 598 and virtualsize <= 105028 and virtualsize > 1 and imageversion > 5000:
    isDirty = False
  elif iatrva <= 0 and imageversion > 4180 and resourcesize > 2484:
    isDirty = False
  elif debugsize <= 0 and numberofsections <= 1 and resourcesize > 501:
    isDirty = False
  elif debugsize <= 0 and exportsize <= 211 and numberofsections > 2 and imageversion > 1000 and resourcesize <= 12996:
    isDirty = True
  elif debugsize <= 0 and exportsize <= 211 and numberofsections > 2 and resourcesize > 0 and virtualsize > 1016:
    isDirty = True
  elif numberofsections > 8 and virtualsize <= 2221:
    isDirty = True
  elif resourcesize <= 736 and numberofsections <= 3:
    isDirty = True
  elif numberofsections <= 3 and iatrva > 4156:
    isDirty = False
  elif imageversion <= 6000 and resourcesize <= 523 and iatrva > 0 and exportsize <= 95:
    isDirty = True
  elif exportsize <= 256176 and debugsize > 0 and imageversion <= 5450 and iatrva > 1664 and resourcesize <= 2040 and debugsize <= 41:
    isDirty = False
  elif exportsize <= 256176 and imageversion > 5450:
    isDirty = False
  elif exportsize > 256176:
    isDirty = True
  elif imageversion > 0 and resourcesize > 298216 and iatrva <= 2048:
    isDirty = True
  elif imageversion > 0 and exportsize > 74 and debugsize > 0:
    isDirty = False
  elif imageversion > 0 and virtualsize > 4185 and resourcesize <= 215376 and iatrva <= 2048 and numberofsections <= 5:
    isDirty = False
  elif imageversion > 1010 and debugsize <= 56 and virtualsize <= 215376:
    isDirty = False
  elif exportsize > 258 and numberofsections > 3 and debugsize > 0:
    isDirty = False
  elif exportsize > 262 and imageversion > 0 and numberofsections > 7:
    isDirty = False
  elif debugsize > 41 and numberofsections <= 4:
    isDirty = False
  elif exportsize <= 262 and numberofsections > 3 and virtualsize <= 37:
    isDirty = True
  elif virtualsize > 40 and exportsize <= 262 and debugsize <= 0 and imageversion <= 353 and exportsize <= 142:
    isDirty = True
  elif virtualsize > 72384 and virtualsize <= 263848:
    isDirty = True
  elif iatrva > 106496 and iatrva <= 937984 and debugsize > 0 and resourcesize > 4358:
    isDirty = False
  elif virtualsize <= 64 and iatrva <= 2048 and debugsize <= 0 and imageversion <= 353 and exportsize <= 0 and virtualsize <= 4 and numberofsections <= 2:
    isDirty = False
  elif debugsize <= 0 and numberofsections <= 4 and iatrva > 45548:
    isDirty = True
  elif debugsize > 0 and debugsize <= 56 and iatrva <= 94208 and resourcesize <= 4096:
    isDirty = True
  elif debugsize <= 0 and iatrva <= 98304 and numberofsections > 6 and resourcesize <= 864 and exportsize > 74 and imageversion > 353 and exportsize <= 279:
    isDirty = False
  elif debugsize <= 0 and iatrva <= 98304 and numberofsections <= 2 and resourcesize <= 1264128:
    isDirty = True
  elif virtualsize <= 64 and iatrva <= 2048 and debugsize > 0:
    isDirty = False
  elif exportsize <= 276 and numberofsections > 5 and resourcesize <= 1076:
    isDirty = False
  elif debugsize > 0 and iatrva <= 94208 and exportsize <= 82 and debugsize <= 56 and numberofsections > 2 and imageversion <= 2340 and resourcesize <= 118280 and virtualsize > 5340:
    isDirty = False
  elif debugsize > 0 and imageversion <= 2340 and debugsize <= 56 and numberofsections > 3 and virtualsize > 360 and numberofsections <= 5:
    isDirty = True
  elif iatrva > 37380 and imageversion <= 0 and numberofsections <= 5 and virtualsize > 15864:
    isDirty = False
  elif debugsize <= 0 and virtualsize <= 80 and iatrva <= 4096 and exportsize <= 0 and virtualsize > 4 and virtualsize <= 21:
    isDirty = False
  elif debugsize <= 0:
    isDirty = True
  elif exportsize <= 82 and debugsize <= 56 and numberofsections <= 5 and numberofsections > 2 and iatrva <= 6144 and imageversion > 2340:
    isDirty = False
  elif imageversion > 2340:
    isDirty = True
  elif resourcesize > 5528:
    isDirty = False
  else:
    isDirty = True
  return isDirty

def run_Ridor(debugsize, imageversion, iatrva, exportsize, resourcesize, virtualsize, numberofsections):
  isDirty = False
  #Except (debugsize <= 14) and (imageversion <= 760) and (virtualsize > 992) and (exportsize <= 80.5) => isDirty = True  (1702.0/16.0) [855.0/5.0]
  if debugsize <= 14 and imageversion <= 760 and virtualsize > 992 and exportsize <= 80.5:
    isDirty = True
#Except (debugsize <= 14) and (imageversion <= 4525) and (exportsize <= 198.5) and (resourcesize <= 37532) and (virtualsize <= 6) and (resourcesize <= 7348) and (resourcesize > 1773) => isDirty = True  (106.0/0.0) [48.0/0.0]
  elif debugsize <= 14 and imageversion <= 4525  and exportsize <= 198.5 and resourcesize <= 7348 and virtualsize <=6 and resourcesize > 1773:
    isDirty = True
#Except (debugsize <= 14) and (imageversion <= 4950) and (exportsize <= 192) and (iatrva > 256) and (virtualsize > 42) and (exportsize <= 56) and (numberofsections > 3.5) => isDirty = True  (193.0/0.0) [91.0/0.0]
  elif debugsize <= 14 and imageversion <= 4950 and exportsize <= 56 and iatrva > 256 and virtualsize > 42 and numberofsections > 3.5:
    isDirty = True
#Except (debugsize <= 14) and (imageversion <= 4950) and (virtualsize <= 6) and (resourcesize <= 37532) and (resourcesize <= 17302) => isDirty = True  (388.0/0.0) [216.0/7.0]
  elif debugsize <= 14 and imageversion <= 4950 and virtualsize <= 6 and resourcesize > 17302:
    isDirty = True
#Except (debugsize <= 14) and (numberofsections > 2.5) and (resourcesize > 1776) and (iatrva <= 6144) and (exportsize <= 219.5) and (virtualsize > 2410) and (virtualsize <= 61224) => isDirty = True  (238.0/0.0) [116.0/0.0]
  elif debugsize <= 14 and numberofsections >= 2.5 and resourcesize <= 1776 and iatrva <= 6144 and exportsize <= 219.5 and virtualsize > 2410 and virtualsize <= 61224:
    isDirty = True
#Except (debugsize <= 14) and (numberofsections > 2.5) and (exportsize <= 198) and (resourcesize > 8) and (virtualsize > 83) and (resourcesize <= 976) => isDirty = True  (151.0/2.0) [83.0/2.0]
  elif debugsize <= 14 and numberofsections >= 2.5 and exportsize  <= 198 and resourcesize > 8 and virtualsize > 83 and resourcesize <= 976:
    isDirty = True
#Except (debugsize <= 14) and (numberofsections > 2.5) and (resourcesize > 1418) and (iatrva <= 6144) and (virtualsize <= 4) => isDirty = True  (94.0/0.0) [44.0/0.0]
  elif debugsize <= 14 and numberofsections >= 2.5 and resourcesize > 1418 and iatrva > 6144 and virtualsize <= 4:
    isDirty = True
#Except (debugsize <= 14) and (virtualsize > 14) and (numberofsections <= 4.5) and (resourcesize > 8) and (virtualsize <= 2398) and (resourcesize > 1550) => isDirty = True  (84.0/0.0) [41.0/1.0]
  elif debugsize <= 14 and virtualsize > 14 and numberofsections > 4.5 and resourcesize > 1550 and virtualsize <= 2398:
    isDirty = True
#Except (debugsize <= 14) and (virtualsize > 14) and (numberofsections <= 4.5) and (exportsize <= 138.5) and (imageversion > 1005) => isDirty = True  (37.0/0.0) [17.0/0.0]
  elif debugsize <= 14 and virtualsize > 14 and numberofsections > 4.5 and exportsize > 138.5 and imageversion > 1005:
    isDirty = True
#Except (imageversion <= 5005) and (debugsize <= 14) and (virtualsize > 14) and (numberofsections <= 4.5) => isDirty = True  (182.0/20.0) [88.0/6.0]
  elif imageversion <= 5005 and debugsize <= 14 and virtualsize > 14 and numberofsections <= 4.5:
    isDirty = True
#Except (imageversion <= 5005) and (debugsize <= 14) and (imageversion <= 5) and (numberofsections > 3.5) and (exportsize <= 164.5) and (iatrva <= 73728) and (resourcesize <= 8722) => isDirty = True  (47.0/0.0) [18.0/2.0]
  elif imageversion <= 5005 and debugsize <= 14 and imageversion <=5 and numberofsections > 3.5 and exportsize <= 164.5 and iatrva <= 73728 and resourcesize <= 8722:
    isDirty = True
#Except (imageversion <= 5005) and (debugsize <= 14) and (resourcesize > 21108) and (resourcesize <= 37272) and (imageversion <= 760) => isDirty = True  (51.0/0.0) [30.0/3.0]
  elif imageversion <= 5005 and debugsize <= 14 and resourcesize > 21108 and resourcesize <= 37272 and imageversion <= 760:
    isDirty = True
#Except (numberofsections > 4.5) and (exportsize <= 25.5) and (imageversion > 1505) and (resourcesize <= 1020) => isDirty = True  (51.0/0.0) [30.0/2.0]
  elif numberofsections > 4.5 and exportsize <= 25.5 and imageversion > 1505 and resourcesize <= 1020:
    isDirty = True
# Except (imageversion <= 1500) and (numberofsections > 5.5) and (exportsize <= 101) and (resourcesize <= 3168) => isDirty = True  (16.0/0.0) [8.0/1.0]
  elif imageversion <= 1500 and numberofsections > 5.5 and exportsize <= 101 and resourcesize <= 3168:
    isDirty = True
#Except (imageversion <= 3025) and (debugsize <= 14) and (resourcesize > 1182) and (virtualsize > 164) and (exportsize <= 330.5) => isDirty = True  (32.0/7.0) [20.0/4.0]
  elif imageversion <= 3025 and debugsize <= 14 and resourcesize > 1182 and virtualsize > 164 and exportsize <= 330.5:
    isDirty = True
# Except (imageversion <= 1010) and (resourcesize > 2352) and (virtualsize > 39914) and (virtualsize <= 153258) and (virtualsize > 115254) => isDirty = True  (19.0/0.0) [8.0/2.0]
  elif imageversion <= 1010 and resourcesize > 2352 and virtualsize > 115254 and virtualsize <= 153258:
    isDirty = True
#Except (imageversion <= 1500) and (numberofsections > 5.5) and (imageversion <= 500) and (exportsize <= 164) and (iatrva <= 2048) => isDirty = True  (7.0/0.0) [3.0/0.0]
  elif imageversion <= 1500 and numberofsections > 5.5 and imageversion <= 500 and exportsize <= 164 and iatrva <= 2048:
    isDirty = True
# Except (imageversion <= 1010) and (resourcesize <= 474) and (iatrva > 26624) and (virtualsize > 1802) and (iatrva <= 221348) => isDirty = True  (15.0/0.0) [5.0/2.0]
  elif imageversion <= 1010 and resourcesize <= 474 and iatrva > 26624 and virtualsize > 1802 and iatrva <= 221348:
    isDirty = True
# Except (imageversion <= 2500) and (debugsize <= 14) and (resourcesize > 4320) and (resourcesize <= 389246) and (resourcesize > 78678) and (numberofsections <= 4) and (resourcesize <= 120928) => isDirty = True  (7.0/0.0) [3.0/1.0]
  elif imageversion <= 2500 and debugsize <= 14 and resourcesize > 78678 and resourcesize <= 120928 and numberofsections <= 4:
    isDirty = True
# Except (imageversion <= 5005) and (exportsize <= 25.5) and (numberofsections > 3.5) and (resourcesize > 35814) and (virtualsize > 215352) => isDirty = True  (5.0/0.0) [1.0/0.0]
  elif imageversion <= 5005 and exportsize <= 25.5 and numberofsections > 3.5 and resourcesize > 35814 and virtualsize > 215352:
    isDirty = True
# Except (imageversion <= 4005) and (iatrva <= 2560) and (numberofsections > 3.5) and (imageversion <= 500) and (resourcesize > 648) and (resourcesize <= 62291) => isDirty = True  (9.0/0.0) [4.0/1.0]
  elif imageversion <= 500 and iatrva <= 2560 and numberofsections > 3.5 and resourcesize > 648 and resourcesize <= 62291:
    isDirty = True
# Except (exportsize <= 25.5) and (numberofsections > 4.5) and (virtualsize > 50765) and (resourcesize <= 741012) and (resourcesize > 2512) => isDirty = True  (13.0/0.0) [6.0/0.0]
  elif exportsize <= 25.5 and numberofsections > 4.5 and virtualsize > 50765 and resourcesize <= 741012 and resourcesize > 2512:
    isDirty = True
# Except (imageversion <= 1010) and (exportsize <= 25.5) and (virtualsize > 63) and (virtualsize <= 3448) and (resourcesize > 2032) and (virtualsize > 1200) and (virtualsize <= 3278) => isDirty = True  (7.0/0.0) [4.0/2.0]
  elif imageversion <= 1010 and exportsize <= 25.5 and virtualsize <= 3278 and virtualsize > 1200 and resourcesize > 2032:
    isDirty = True
#Except (resourcesize <= 474) and (exportsize <= 76) and (virtualsize <= 1556) and (iatrva <= 2368) => isDirty = True  (13.0/0.0) [2.0/0.0]
  elif resourcesize <= 474 and exportsize <= 76 and virtualsize <= 1556 and iatrva <= 2368:
    isDirty = True
# Except (imageversion <= 1500) and (virtualsize <= 6) and (iatrva > 2048) => isDirty = True  (8.0/0.0) [4.0/1.0]
  elif imageversion <= 1500 and virtualsize <= 6 and iatrva > 2048:
    isDirty = True
  else:
    isDirty = False
  return isDirty

